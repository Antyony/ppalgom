<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>들곰다대기 계산기</title>
  <style>
    :root { --b:#e5e7eb; --m:#6b7280; --bg:#fafafa; }
    body { margin:0; background:var(--bg); color:#111827;
      font-family: system-ui, -apple-system, "Apple SD Gothic Neo", "Noto Sans KR", Segoe UI, Roboto, Arial, sans-serif; }
    .wrap { max-width: 760px; margin: 24px auto; padding: 0 14px; }
    .card { background:#fff; border:1px solid var(--b); border-radius:14px; padding: 16px; }
    h1 { font-size: 18px; margin:0 0 12px; }
    .mode { display:flex; gap:14px; flex-wrap:wrap; align-items:center; }
    label { display:flex; gap:8px; align-items:center; cursor:pointer; }
    .row { display:flex; gap:10px; flex-wrap:wrap; align-items:center; margin-top:10px; }
    input[type="number"]{ flex: 1 1 260px; padding: 10px 12px; font-size:16px; border:1px solid var(--b); border-radius:10px; }
    button { padding: 10px 14px; font-size: 15px; border-radius:10px; border:1px solid var(--b); background:#fff; cursor:pointer; }
    button:hover { background:#f9fafb; }
    .pill { display:inline-block; padding:2px 10px; border:1px solid var(--b); border-radius:999px; font-size:12px; color:var(--m); }
    .hint { color: var(--m); font-size: 12px; margin-top: 8px; }
    .err { display:none; margin-top:10px; color:#b91c1c; font-size: 13px; }
    table { width:100%; border-collapse:collapse; margin-top: 14px; }
    th, td { border-bottom:1px solid var(--b); padding: 10px 8px; }
    th { text-align:left; color: var(--m); font-size: 12px; }
    td.num, th.num { text-align:right; font-variant-numeric: tabular-nums; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>들곰다대기 계산기</h1>

      <div class="mode" role="radiogroup" aria-label="계산 기준 선택">
        <label><input type="radio" name="mode" value="weight" checked> 중량(g) 기준</label>
        <label><input type="radio" name="mode" value="servings"> 인분 기준</label>
        <span class="pill" id="unitPill">g</span>
      </div>

      <div class="row">
        <input id="valueInput" type="number" inputmode="decimal" min="0" step="0.01" placeholder="생산될 총 중량 (g) 입력" />
        <button id="calcBtn" type="button">계산하기</button>
      </div>
      <div class="hint">중량/인분 값을 입력한 뒤 <strong>계산하기</strong>를 누르면 아래 표에 투입량이 표시돼.</div>
      <div class="err" id="err"></div>

      <table>
        <thead>
          <tr>
            <th>재료</th>
            <th class="num">투입량(g)</th>
          </tr>
        </thead>
        <tbody id="tbody"></tbody>
      </table>
    </div>
  </div>

<script>
(() => {
  // ===== 기준 레시피: 1.2인분 =====
  const BASE_SERVINGS = 1.2;
  const ING = [
    { name: "들깨가루(국내산)", g: 15.00 },
    { name: "찹쌀가루",         g: 10.00 },
    { name: "백후추",           g: 0.10 },
    { name: "마늘가루",         g: 0.50 },
    { name: "물",              g: 27.50 }
  ];
  const BASE_TOTAL_G = ING.reduce((s, x) => s + x.g, 0);

  // ===== DOM =====
  const radios = Array.from(document.querySelectorAll('input[name="mode"]'));
  const valueInput = document.getElementById('valueInput');
  const unitPill = document.getElementById('unitPill');
  const calcBtn = document.getElementById('calcBtn');
  const tbody = document.getElementById('tbody');
  const err = document.getElementById('err');

  function mode() {
    const r = radios.find(x => x.checked);
    return r ? r.value : "weight";
  }

  function fmt(n) {
    if (!isFinite(n)) return "-";
    const abs = Math.abs(n);
    if (abs < 0.01) return n.toFixed(4);
    if (abs < 1) return n.toFixed(3);
    return n.toFixed(2);
  }

  function clearTable() {
    tbody.innerHTML = "";
    for (const it of ING) {
      const tr = document.createElement('tr');
      tr.innerHTML = `<td>${it.name}</td><td class="num">-</td>`;
      tbody.appendChild(tr);
    }
  }

  function syncUI() {
    const m = mode();
    err.style.display = "none";
    err.textContent = "";
    if (m === "weight") {
      valueInput.placeholder = "생산될 총 중량 (g) 입력";
      unitPill.textContent = "g";
    } else {
      valueInput.placeholder = "생산될 인분 수 입력";
      unitPill.textContent = "인분";
    }
  }

  function calculate() {
    const m = mode();
    const rawStr = (valueInput.value || "").trim();
    const raw = parseFloat(rawStr);

    err.style.display = "none";
    err.textContent = "";

    if (!rawStr || !isFinite(raw) || raw <= 0) {
      err.style.display = "block";
      err.textContent = "값을 숫자로 입력해줘. (0보다 큰 값)";
      clearTable();
      return;
    }

    const scale = (m === "weight") ? (raw / BASE_TOTAL_G) : (raw / BASE_SERVINGS);

    tbody.innerHTML = "";
    for (const it of ING) {
      const out = it.g * scale;
      const tr = document.createElement('tr');
      tr.innerHTML = `<td>${it.name}</td><td class="num">${fmt(out)}</td>`;
      tbody.appendChild(tr);
    }
  }

  // Events
  radios.forEach(r => r.addEventListener('change', () => { syncUI(); clearTable(); }));
  calcBtn.addEventListener('click', calculate);

  // Enter key triggers calculation
  valueInput.addEventListener('keydown', (e) => {
    if (e.key === 'Enter') calculate();
  });

  // init
  syncUI();
  clearTable();
})();
</script>
</body>
</html>
